# ğŸ” Aura Gallery ê´€ë¦¬ì ì‹œìŠ¤í…œ ì„¤ì • ê°€ì´ë“œ

> ë°±ì—”ë“œ ê°œë°œ ê²½í—˜ì´ ì—†ì–´ë„ ë”°ë¼í•  ìˆ˜ ìˆëŠ” ë‹¨ê³„ë³„ ê°€ì´ë“œì…ë‹ˆë‹¤.

---

## ğŸ“Œ ì „ì²´ êµ¬ì¡° ì´í•´í•˜ê¸°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Aura Gallery ì‹œìŠ¤í…œ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  [ì‚¬ìš©ì ë¸Œë¼ìš°ì €]                                            â”‚
â”‚       â”‚                                                     â”‚
â”‚       â–¼                                                     â”‚
â”‚  [Next.js ì•±] â—„â”€â”€â”€â”€â”€â”€â–º [Vercel Postgres DB]                 â”‚
â”‚       â”‚                    (í”„ë¡œì íŠ¸/ì‚¬ìš©ì ì •ë³´ ì €ì¥)          â”‚
â”‚       â”‚                                                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º [Vercel Blob Storage]                â”‚
â”‚                           (ì´ë¯¸ì§€ íŒŒì¼ ì €ì¥)                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ’¡ í•µì‹¬ ê°œë… ì„¤ëª…

| ìš©ì–´ | ì‰¬ìš´ ì„¤ëª… |
|------|----------|
| **Next.js** | ì›¹ì‚¬ì´íŠ¸ë¥¼ ë§Œë“œëŠ” ë„êµ¬ (í”„ë ˆì„ì›Œí¬) |
| **Prisma** | ë°ì´í„°ë² ì´ìŠ¤ì™€ ëŒ€í™”í•˜ëŠ” í†µì—­ì‚¬ (ORM) |
| **NextAuth** | ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒì„ ë‹´ë‹¹í•˜ëŠ” ë³´ì•ˆê´€ |
| **Vercel Postgres** | í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” ì˜¨ë¼ì¸ ì°½ê³  (ë°ì´í„°ë² ì´ìŠ¤) |
| **Vercel Blob** | ì´ë¯¸ì§€ íŒŒì¼ì„ ì €ì¥í•˜ëŠ” ì˜¨ë¼ì¸ ì°½ê³  (íŒŒì¼ ì €ì¥ì†Œ) |

---

## ğŸš€ ì„¤ì • ê³¼ì • (ìˆœì„œëŒ€ë¡œ ë”°ë¼í•˜ê¸°)

### Phase 1: Vercel ìŠ¤í† ë¦¬ì§€ ì—°ê²°

#### 1-1. Vercel CLI ì„¤ì¹˜ ë° ë¡œê·¸ì¸
```bash
# Vercel CLI ì„¤ì¹˜
npm install -g vercel

# Vercel ê³„ì • ë¡œê·¸ì¸
vercel login
```

#### 1-2. í”„ë¡œì íŠ¸ ì—°ê²°
```bash
# í”„ë¡œì íŠ¸ í´ë”ì—ì„œ ì‹¤í–‰
vercel link
```
ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
ë¡œì»¬ í”„ë¡œì íŠ¸ì™€ Vercel í´ë¼ìš°ë“œê°€ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.

#### 1-3. Postgres ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± ë° ì—°ê²°
vercel storage create postgres gallery-db
```
ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
í´ë¼ìš°ë“œì— ë°ì´í„°ë² ì´ìŠ¤ê°€ ë§Œë“¤ì–´ì§€ê³ , ì—°ê²° ì •ë³´ê°€ ìë™ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.

#### 1-4. Blob ìŠ¤í† ë¦¬ì§€ ìƒì„±
```bash
# ì´ë¯¸ì§€ ì €ì¥ì†Œ ìƒì„± ë° ì—°ê²°
vercel storage create blob gallery-images
```
ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
ì´ë¯¸ì§€ íŒŒì¼ì„ ì €ì¥í•  í´ë¼ìš°ë“œ ê³µê°„ì´ ë§Œë“¤ì–´ì¡ŒìŠµë‹ˆë‹¤.

#### 1-5. í™˜ê²½ ë³€ìˆ˜ ê°€ì ¸ì˜¤ê¸°
```bash
# ì—°ê²° ì •ë³´ë¥¼ ë¡œì»¬ë¡œ ê°€ì ¸ì˜¤ê¸°
vercel env pull .env.local
```
ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
ë°ì´í„°ë² ì´ìŠ¤/ìŠ¤í† ë¦¬ì§€ ì ‘ì† ì •ë³´ê°€ `.env.local` íŒŒì¼ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.

---

### Phase 2: ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •

#### 2-1. Prisma ìŠ¤í‚¤ë§ˆ ì‘ì„±
`prisma/schema.prisma` íŒŒì¼ì—ì„œ ë°ì´í„° êµ¬ì¡°ë¥¼ ì •ì˜í•©ë‹ˆë‹¤:

```prisma
model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  role      String   @default("ADMIN")
}

model Project {
  id          String   @id @default(cuid())
  slug        String   @unique
  title       String
  category    String
  year        Int
  thumbnail   String?
  description String?
  published   Boolean  @default(true)
  images      Image[]
}

model Image {
  id        String   @id @default(cuid())
  url       String
  alt       String?
  projectId String
  project   Project  @relation(fields: [projectId], references: [id])
}
```

ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  ì •ë³´ì˜ "ì„¤ê³„ë„"ë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.

#### 2-2. ë°ì´í„°ë² ì´ìŠ¤ì— ì ìš©
```bash
# ìŠ¤í‚¤ë§ˆë¥¼ ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ì— ì ìš©
npx prisma db push
```
ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
ì„¤ê³„ë„ëŒ€ë¡œ ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

#### 2-3. ê´€ë¦¬ì ê³„ì • ìƒì„± (Seed)
```bash
# ì´ˆê¸° ê´€ë¦¬ì ê³„ì • ë° ìƒ˜í”Œ ë°ì´í„° ìƒì„±
npx prisma db seed
```
ğŸ“ **ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚¬ë‚˜ìš”?**  
`prisma/seed.ts` íŒŒì¼ì˜ ë‚´ìš©ëŒ€ë¡œ ì´ˆê¸° ë°ì´í„°ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

**ê¸°ë³¸ ê´€ë¦¬ì ê³„ì •:**
- ğŸ“§ ì´ë©”ì¼: `admin@aura.gallery`
- ğŸ”‘ ë¹„ë°€ë²ˆí˜¸: `admin123`

---

### Phase 3: ì¸ì¦ ì‹œìŠ¤í…œ (NextAuth)

#### 3-1. NextAuth ì„¤ì •
`src/lib/auth.ts` íŒŒì¼ì´ ë¡œê·¸ì¸ ë¡œì§ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤:

```typescript
// ê°„ëµí™”ëœ êµ¬ì¡°
export const { handlers, signIn, signOut, auth } = NextAuth({
  providers: [
    Credentials({
      async authorize(credentials) {
        // 1. ì´ë©”ì¼ë¡œ ì‚¬ìš©ì ì°¾ê¸°
        // 2. ë¹„ë°€ë²ˆí˜¸ í™•ì¸
        // 3. ì„±ê³µì‹œ ì‚¬ìš©ì ì •ë³´ ë°˜í™˜
      },
    }),
  ],
});
```

#### 3-2. ë³´í˜¸ëœ í˜ì´ì§€ ì„¤ì •
`src/middleware.ts`ê°€ ê´€ë¦¬ì í˜ì´ì§€ë¥¼ ë³´í˜¸í•©ë‹ˆë‹¤:
- `/admin/*` ê²½ë¡œëŠ” ë¡œê·¸ì¸ í•„ìš”
- ë¡œê·¸ì¸ ì•ˆ í–ˆìœ¼ë©´ `/admin/login`ìœ¼ë¡œ ì´ë™

---

### Phase 4: ê´€ë¦¬ì í˜ì´ì§€

#### í˜ì´ì§€ êµ¬ì¡°
```
src/app/admin/
â”œâ”€â”€ login/page.tsx      # ë¡œê·¸ì¸ í˜ì´ì§€
â”œâ”€â”€ page.tsx            # ëŒ€ì‹œë³´ë“œ (í†µê³„ í‘œì‹œ)
â””â”€â”€ projects/
    â”œâ”€â”€ page.tsx        # í”„ë¡œì íŠ¸ ëª©ë¡
    â”œâ”€â”€ new/page.tsx    # ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
    â””â”€â”€ [id]/
        â””â”€â”€ edit/page.tsx  # í”„ë¡œì íŠ¸ ìˆ˜ì •
```

#### API ì—”ë“œí¬ì¸íŠ¸
```
src/app/api/
â”œâ”€â”€ auth/[...nextauth]/ # ì¸ì¦ API
â”œâ”€â”€ projects/           # í”„ë¡œì íŠ¸ CRUD
â”‚   â”œâ”€â”€ route.ts        # GET(ëª©ë¡), POST(ìƒì„±)
â”‚   â””â”€â”€ [id]/route.ts   # GET/PUT/DELETE(ê°œë³„)
â””â”€â”€ upload/route.ts     # ì´ë¯¸ì§€ ì—…ë¡œë“œ
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ë°©ë²•

### ê°œë°œ ì„œë²„ ì‹¤í–‰
```bash
npm run dev
```

### ê´€ë¦¬ì í˜ì´ì§€ ì ‘ì†
1. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:3000/admin/login` ì ‘ì†
2. ì´ë©”ì¼: `admin@aura.gallery`
3. ë¹„ë°€ë²ˆí˜¸: `admin123`
4. ë¡œê·¸ì¸ í›„ ëŒ€ì‹œë³´ë“œì—ì„œ í”„ë¡œì íŠ¸ ê´€ë¦¬

---

## â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸

### Q: ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°”ê¾¸ê³  ì‹¶ì–´ìš”
`prisma/seed.ts` íŒŒì¼ì—ì„œ `adminPassword` ê°’ì„ ë³€ê²½í•œ í›„:
```bash
# ê¸°ì¡´ ë°ì´í„° ì‚­ì œ í›„ ì¬ìƒì„± í•„ìš”
npx prisma db push --force-reset
npx prisma db seed
```

### Q: ìƒˆ ê´€ë¦¬ìë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ì–´ìš”
`prisma/seed.ts`ì— ìƒˆ ì‚¬ìš©ì ìƒì„± ì½”ë“œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜, Prisma Studioë¥¼ ì‚¬ìš©:
```bash
npx prisma studio
```
ë¸Œë¼ìš°ì €ì—ì„œ User í…Œì´ë¸”ì— ì§ì ‘ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### Q: ë°ì´í„°ë² ì´ìŠ¤ ë‚´ìš©ì„ í™•ì¸í•˜ê³  ì‹¶ì–´ìš”
```bash
npx prisma studio
```
ë¸Œë¼ìš°ì €ì—ì„œ ëª¨ë“  í…Œì´ë¸”ê³¼ ë°ì´í„°ë¥¼ ì‹œê°ì ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“ ì£¼ìš” íŒŒì¼ ëª©ë¡

| íŒŒì¼ | ì—­í•  |
|------|------|
| `prisma/schema.prisma` | ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ì •ì˜ |
| `prisma/seed.ts` | ì´ˆê¸° ë°ì´í„° ìƒì„± ìŠ¤í¬ë¦½íŠ¸ |
| `src/lib/auth.ts` | ì¸ì¦ ë¡œì§ |
| `src/lib/prisma.ts` | ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° |
| `src/middleware.ts` | í˜ì´ì§€ ì ‘ê·¼ ì œì–´ |
| `src/middleware.ts` | í˜ì´ì§€ ì ‘ê·¼ ì œì–´ |
| `.env.local` | í™˜ê²½ ë³€ìˆ˜ (ë¹„ë°€ ì •ë³´) |

---

## ğŸš¨ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ (Vercel ë°°í¬ ì‹œ ì£¼ì˜ì‚¬í•­)

ë‹¤ìŒì€ ì‹¤ì œ ê°œë°œ ê³¼ì •ì—ì„œ ë°œìƒí–ˆë˜ ì˜¤ë¥˜ë“¤ê³¼ í•´ê²° ë°©ë²•ì…ë‹ˆë‹¤.

### 1. Prisma Client íƒ€ì… ì˜¤ë¥˜ (Build Error)
**ì¦ìƒ**:  
`Type error: Module '"@prisma/client"' has no exported member 'PrismaClient'.`

**ì›ì¸**:  
Vercelì€ ë¹Œë“œ ì‹œ `npm install`ë§Œ ìˆ˜í–‰í•˜ë¯€ë¡œ, `postinstall` ìŠ¤í¬ë¦½íŠ¸ê°€ ì—†ë‹¤ë©´ Prisma Clientê°€ ìƒì„±ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

**í•´ê²°**:  
`package.json`ì— `postinstall` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
```json
"scripts": {
  "postinstall": "prisma generate"
}
```

### 2. Edge Middleware ì˜¤ë¥˜ (Runtime Error)
**ì¦ìƒ**:  
`Module not found: Can't resolve '.prisma/client/default'`

**ì›ì¸**:  
Next.jsì˜ MiddlewareëŠ” **Edge Runtime**ì—ì„œ ì‹¤í–‰ë˜ëŠ”ë°, ì—¬ê¸°ì„œ Node.js APIì— ì˜ì¡´í•˜ëŠ” Prisma Clientë¥¼ ì§ì ‘ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

**í•´ê²°**:  
ì¸ì¦ ì„¤ì •(`src/lib/auth.config.ts`)ì„ ë¶„ë¦¬í•˜ì—¬ MiddlewareëŠ” Prismaì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ” ìˆœìˆ˜ ë¡œì§ë§Œ ì‚¬ìš©í•˜ë„ë¡ ìˆ˜ì •í•©ë‹ˆë‹¤.
- `auth.config.ts`: ìˆœìˆ˜ JWT/ì„¸ì…˜ ë¡œì§ (Edge í˜¸í™˜)
- `auth.ts`: Prisma Adapter í¬í•¨ (Node.js ì „ìš©)

### 3. ë¡œê·¸ì¸ ì‹œ 500 Server Error
**ì¦ìƒ**:  
ë¡œê·¸ì¸ ì‹œë„ ì‹œ `/api/auth/error` í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë˜ë©° `Server error` ë©”ì‹œì§€ í‘œì‹œ.

**ì›ì¸**:  
Vercel í™˜ê²½ ë³€ìˆ˜ì— ë³´ì•ˆ í‚¤(`AUTH_SECRET`)ê°€ ëˆ„ë½ë˜ì—ˆì„ ë•Œ ë°œìƒí•©ë‹ˆë‹¤. (NextAuth v5 í•„ìˆ˜ ì‚¬í•­)

**í•´ê²°**:  
Vercel í”„ë¡œì íŠ¸ ì„¤ì • > Environment Variablesì—ì„œ `AUTH_SECRET`ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
- Key: `AUTH_SECRET`
- Value: ê¸´ ëœë¤ ë¬¸ìì—´ (ì˜ˆ: `openssl rand -base64 32`)

---

*ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025-12-28*
